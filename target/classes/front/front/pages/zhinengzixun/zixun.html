<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>智能咨询</title>
    <!--    <link rel="stylesheet" href="../../css/zixun.css">-->
    <link rel="stylesheet" href="../../layui/css/layui.css">
    <link rel="stylesheet" href="../../xznstatic/css/common.css"/>
    <link rel="stylesheet" href="../../xznstatic/css/style.css"/>
    <!-- 主题（主要颜色设置） -->
    <link rel="stylesheet" href="../../css/theme.css" />
    <!-- 通用的css -->

    <style>
        /*html, body {*/
        /*    height: 100%;*/
        /*}*/

        /* 聊天窗口样式 */

        .chat-container {
            max-width: 100%;
            margin: 20px auto;
            padding: 20px;
            /*border: 1px solid #bcc9dc;*/
            border-radius: 10px;
            background-image: linear-gradient(#dde9ec, #98b5c6, #87a2c6);
            height: 800px;
            display: flex;
            flex-direction: row;
            /*height: 100%;*/
            /*z-index: 999;*/
        }
        .chat-sidebar{
            position: relative;
            width: 200px;
            max-height:650px;
            background-color:whitesmoke;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 5px rgb(211, 211, 211);
            margin: 20px;
        }
        .chat-title{
            width: 200px;
            height: 45px;
            background-color: #cde8f4;
            border-radius: 5px;
            font-size: 30px;
            color: #66a0e3;
            box-shadow: 0 2px 5px rgb(211, 211, 211);
            text-align: center;
            padding: 15px;
        }

        .new-chat{
            width: 195px;
            height:50px;
            margin-top: 20px;
            margin-right: 10px;
            font-size: 20px;
            border-color: #1b6fec;
            border-width:2px ;
            border-radius: 5px;
            position: relative;
        }

        .person {
            /*display: flex;*/
            position: absolute;
            margin-bottom: 5px;
            left: 50%;
            bottom: 3%;
            transform: translateX(-50%);
            width: 90px;
            height: 90px;
            border-radius: 50%;
            overflow: hidden;
            border: 5px solid #fff;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            padding-bottom: 5px;
        }
        .person-img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* 保持图片比例 */
        }


        .chat-main {
            flex: 1;
            /*border: 1px solid #87a2c6;*/
            border-radius: 10px;
            background-image: linear-gradient(#dde9ec, #98b5c6, #87a2c6);
            padding: 20px;
            display: flex;
            flex-direction: column;
            height: 90%;
        }
        .chat-messages {
            height: calc(90% - 60px); /* 留出输入框空间 */
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fff;
            box-shadow: 0 2px 5px rgb(211, 211, 211);
        }
        .chat-message {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
            font-size: 15px;
        }
        .chat-message.user {
            background-color: #e3f2fd;
            text-align: right;
            max-width: 70%;  /* 新增宽度限制 */
            margin-left: auto;  /* 实现右对齐 */
            margin-bottom: 15px;  /* 增加消息间距 */
            padding: 12px 16px;  /* 增加内边距 */
            border-radius: 15px 15px 0 15px;  /* 圆角优化 */
        }

        .chat-message.bot {
            background-color: #f5f5f5;
            text-align: left;
            max-width: 70%;  /* 新增宽度限制 */
            margin-right: auto;  /* 实现左对齐 */
            margin-bottom: 15px;  /* 增加消息间距 */
            padding: 12px 16px;  /* 增加内边距 */
            border-radius: 15px 15px 15px 0;  /* 圆角优化 */
            font-size: 15px;
        }

        /* 可选：增加消息气泡箭头效果 */
        .chat-message.user::after {
            content: '';
            position: absolute;
            right: -8px;
            top: 10px;
            border: 8px solid transparent;
            border-left-color: #e3f2fd;
        }

        .chat-message.bot::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 10px;
            border: 8px solid transparent;
            border-right-color: #f5f5f5;
        }

        .chat-input {
            display: flex;
        }
        .chat-input textarea {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            resize: none;
            box-shadow: 0 2px 5px rgb(211, 211, 211);
        }
        .chat-input button {
            margin-left: 10px;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background-color: #3b9afb;
            color: #fff;
            cursor: pointer;
            font-size: 20px;
        }
        .chat-input button:hover {
            background-color: #54a0ff;
        }


    </style>
</head>
<body>


<div class="chat-container">
    <div class="chat-sidebar">
        <div class="chat-title">
            AI智能咨询
        </div>
        <button class="new-chat">
            创建新对话
        </button>
        <!-- 历史对话记录-->
        <div class="person">
            <img src="../.././img/fangzha_logo.gif" class="person-img" alt="Logo">
        </div>
    </div>
    <!--<h1>智能咨询</h1>-->
    <div class="chat-main">

        <div class="chat-messages" id="chat-messages">
            <!-- 初始欢迎消息 -->
            <div class="chat-message bot">
                <p>你好，我是防欺诈智能助手。很高兴为您服务！我可以回答关于防欺诈的任何问题，您有什么需要帮助的吗？</p>
            </div>
        </div>
        <div class="chat-input">
            <textarea id="question" placeholder="请输入您的问题..."></textarea>
            <button id="submit-question">发送</button>
        </div>
    </div>
</div>


<script>

    document.getElementById('submit-question').addEventListener('click', function() {
        var question = document.getElementById('question').value.trim();
        if (question) {
            // 添加用户消息
            var userMessage = document.createElement('div');
            userMessage.className = 'chat-message user';
            userMessage.innerHTML = `<p>${question}</p>`;
            document.getElementById('chat-messages').appendChild(userMessage);

            // 清空输入框
            document.getElementById('question').value = '';

            // 调用后端接口
            fetch('/api/zhinengzixun', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ question: question })
            })
                .then(response => response.json())
                .then(data => {
                    // 添加机器人消息
                    var botMessage = document.createElement('div');
                    botMessage.className = 'chat-message bot';
                    botMessage.innerHTML = `<p>${data.answer}</p>`;
                    document.getElementById('chat-messages').appendChild(botMessage);

                    // 滚动到底部
                    document.getElementById('chat-messages').scrollTop = document.getElementById('chat-messages').scrollHeight;
                })
                .catch(error => {
                    console.error('Error:', error);
                    var errorMessage = document.createElement('div');
                    errorMessage.className = 'chat-message bot';
                    errorMessage.innerHTML = `<p>请求失败，请稍后重试。</p>`;
                    document.getElementById('chat-messages').appendChild(errorMessage);
                });
        } else {
            alert('请输入问题！');
        }
    });
</script>
</body>
</html>
